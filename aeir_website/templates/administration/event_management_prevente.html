{% extends 'base.html' %}

{% load crispy_forms_tags %}

{% block title %}AEIR - Administration{% endblock %}

{% block content %}

<div class="row">
    <div class="col-12">
        <strong>Préventes de l'événement :</strong> {{ object.name }} | <strong>Date :</strong> {{ object.date }} | <strong>Capacité maximale :</strong> {{ object.max_capacity }} | <strong>Places vendues :</strong> {{ object.total_participants }}
        <br>
        {% if object.surcapacity %}
            <strong style="color: red;">Attention : capacité maximale atteinte</strong>
        {% endif %}
    </div>
</div>

<hr>

<div class='row'>
    <div class='col-md-5 py-3'>
        <form id="form_filter" method="get">
            {{ filter.form|crispy }}
            <div class="row justify-content-center">
                <input class="btn btn-primary" type="submit" value="Rechercher">
            </div>
        </form>
    </div>
    <div class='col-md-7'>
        <form id="add_adherent" method="post">
            {% csrf_token %}
            <div class='row'>
                <div class='col-12'>
                    <div class="card">
                        <div class="table-wrapper-scroll-y my-custom-scrollbar">
                        <table class="table table-hover">
                            <thead>
                            <tr>
                                <th scope="col">Informations</th>
                                <th scope="col">Photo</th>
                                <th scope="col">Action</th>
                            </tr>
                            </thead>
                            <tbody>
                                {% if filter.qs %}
                                {% for obj in filter.qs %}
                                    <tr>
                                    <td align='center' style='vertical-align: middle;'>
                                        {{ obj.first_name }}
                                        <br>
                                        {{ obj.last_name }}
                                        <br>
                                        {{ obj.school_year }}
                                        <br>
                                        {{ obj.departement }}
                                        <br>
                                        {{ obj.get_number }}   
                                    </td>
                                    <td>
                                        <div>
                                            <img class='img-prevente' src="{{ obj.picture.url }}"/>
                                        </div>                                     
                                    </td>
                                    <td style='vertical-align: middle;'>
                                        <button class="btn btn-sm btn-info" name="adherent_{{ obj.id }}" type="submit"><i class="fas fa-plus"></i> Ajouter</button>
                                    </td>
                                    </tr>
                                {% endfor %}
                                {% else %}
                                    <tr>
                                    <td colspan="10">Aucun résultat ...</td>
                                    </tr>
                                {% endif %}
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class='row pt-3'>
                    <div class='col-12'>
                        <div class="row justify-content-center">
                            <button class="btn btn-info" name='non_adherent' type="submit"><i class="fas fa-plus"></i> Ajouter un non-adhérent</button>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

{% endblock %}
